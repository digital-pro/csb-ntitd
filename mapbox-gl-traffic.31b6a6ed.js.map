{"version":3,"sources":["src/mapbox-gl-traffic.js"],"names":["trafficLayers","id","type","metadata","source","minzoom","filter","layout","visibility","paint","base","stops","property","ref","addLayers","style","layers","before","i","length","newLayers","slice","concat","Object","assign","MapboxTraffic","options","Error","showTraffic","showTrafficButton","trafficSource","render","bind","toggleTraffic","_hideTraffic","_showTraffic","_hasTraffic","_toggle","TrafficButton","show","onToggle","container","child","document","createElement","className","appendChild","display","button","btn","_btn","onclick","elem","prototype","_map","getStyle","keys","sources","sourceName","test","addSource","url","roadLayers","layer","topRoadLayer","trafficStyle","setStyle","setMapIcon","setTrafficIcon","forEach","onAdd","map","on","onRemove","off","parentNode","removeChild","undefined","module","exports","window"],"mappings":"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","file":"mapbox-gl-traffic.31b6a6ed.js","sourceRoot":"..","sourcesContent":["var trafficLayers = [\r\n  {\r\n    id: \"traffic-street-link-bg\",\r\n    type: \"line\",\r\n    metadata: {\r\n      \"mapbox:group\": \"4053de47c16e55481b10fd748eaa994c\"\r\n    },\r\n    source: \"mapbox://mapbox.mapbox-traffic-v1\",\r\n    \"source-layer\": \"traffic\",\r\n    minzoom: 15,\r\n    filter: [\r\n      \"all\",\r\n      [\"==\", \"$type\", \"LineString\"],\r\n      [\r\n        \"all\",\r\n        [\"has\", \"congestion\"],\r\n        [\"in\", \"class\", \"link\", \"motorway_link\", \"service\", \"street\"]\r\n      ]\r\n    ],\r\n    layout: {\r\n      visibility: \"visible\",\r\n      \"line-join\": \"round\",\r\n      \"line-cap\": \"round\"\r\n    },\r\n    paint: {\r\n      \"line-width\": {\r\n        base: 1.5,\r\n        stops: [\r\n          [14, 2.5],\r\n          [20, 15.5]\r\n        ]\r\n      },\r\n      \"line-color\": {\r\n        base: 1,\r\n        type: \"categorical\",\r\n        property: \"congestion\",\r\n        stops: [\r\n          [\"low\", \"hsl(145, 95%, 30%)\"],\r\n          [\"moderate\", \"hsl(30, 100%, 42%)\"],\r\n          [\"heavy\", \"hsl(355, 100%, 37%)\"],\r\n          [\"severe\", \"hsl(355, 70%, 22%)\"]\r\n        ]\r\n      },\r\n      \"line-offset\": {\r\n        base: 1.5,\r\n        stops: [\r\n          [14, 2],\r\n          [20, 18]\r\n        ]\r\n      },\r\n      \"line-opacity\": {\r\n        base: 1,\r\n        stops: [\r\n          [15, 0],\r\n          [16, 1]\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  {\r\n    id: \"traffic-secondary-tertiary-bg\",\r\n    type: \"line\",\r\n    metadata: {\r\n      \"mapbox:group\": \"4053de47c16e55481b10fd748eaa994c\"\r\n    },\r\n    source: \"mapbox://mapbox.mapbox-traffic-v1\",\r\n    \"source-layer\": \"traffic\",\r\n    minzoom: 6,\r\n    filter: [\r\n      \"all\",\r\n      [\"==\", \"$type\", \"LineString\"],\r\n      [\"all\", [\"has\", \"congestion\"], [\"in\", \"class\", \"secondary\", \"tertiary\"]]\r\n    ],\r\n    layout: {\r\n      visibility: \"visible\",\r\n      \"line-join\": \"round\",\r\n      \"line-cap\": \"round\"\r\n    },\r\n    paint: {\r\n      \"line-width\": {\r\n        base: 1.5,\r\n        stops: [\r\n          [9, 1.5],\r\n          [18, 11],\r\n          [20, 16.5]\r\n        ]\r\n      },\r\n      \"line-color\": {\r\n        base: 1,\r\n        type: \"categorical\",\r\n        property: \"congestion\",\r\n        stops: [\r\n          [\"low\", \"hsl(145, 95%, 30%)\"],\r\n          [\"moderate\", \"hsl(30, 100%, 42%)\"],\r\n          [\"heavy\", \"hsl(355, 100%, 37%)\"],\r\n          [\"severe\", \"hsl(355, 70%, 22%)\"]\r\n        ]\r\n      },\r\n      \"line-offset\": {\r\n        base: 1.5,\r\n        stops: [\r\n          [10, 0.5],\r\n          [15, 5],\r\n          [18, 11],\r\n          [20, 14.5]\r\n        ]\r\n      },\r\n      \"line-opacity\": {\r\n        base: 1,\r\n        stops: [\r\n          [13, 0],\r\n          [14, 1]\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  {\r\n    id: \"traffic-primary-bg\",\r\n    type: \"line\",\r\n    metadata: {\r\n      \"mapbox:group\": \"4053de47c16e55481b10fd748eaa994c\"\r\n    },\r\n    source: \"mapbox://mapbox.mapbox-traffic-v1\",\r\n    \"source-layer\": \"traffic\",\r\n    minzoom: 6,\r\n    filter: [\r\n      \"all\",\r\n      [\"==\", \"$type\", \"LineString\"],\r\n      [\"all\", [\"==\", \"class\", \"primary\"], [\"has\", \"congestion\"]]\r\n    ],\r\n    layout: {\r\n      visibility: \"visible\",\r\n      \"line-join\": \"round\",\r\n      \"line-cap\": \"round\"\r\n    },\r\n    paint: {\r\n      \"line-width\": {\r\n        base: 1.5,\r\n        stops: [\r\n          [10, 0.75],\r\n          [15, 6],\r\n          [20, 18]\r\n        ]\r\n      },\r\n      \"line-color\": {\r\n        base: 1,\r\n        type: \"categorical\",\r\n        property: \"congestion\",\r\n        stops: [\r\n          [\"low\", \"hsl(145, 95%, 30%)\"],\r\n          [\"moderate\", \"hsl(30, 100%, 42%)\"],\r\n          [\"heavy\", \"hsl(355, 100%, 37%)\"],\r\n          [\"severe\", \"hsl(355, 70%, 22%)\"]\r\n        ]\r\n      },\r\n      \"line-offset\": {\r\n        base: 1.2,\r\n        stops: [\r\n          [10, 0],\r\n          [12, 1.5],\r\n          [18, 13],\r\n          [20, 16]\r\n        ]\r\n      },\r\n      \"line-opacity\": {\r\n        base: 1,\r\n        stops: [\r\n          [11, 0],\r\n          [12, 1]\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  {\r\n    id: \"traffic-trunk-bg\",\r\n    type: \"line\",\r\n    metadata: {\r\n      \"mapbox:group\": \"4053de47c16e55481b10fd748eaa994c\"\r\n    },\r\n    source: \"mapbox://mapbox.mapbox-traffic-v1\",\r\n    \"source-layer\": \"traffic\",\r\n    minzoom: 6,\r\n    filter: [\r\n      \"all\",\r\n      [\"==\", \"$type\", \"LineString\"],\r\n      [\"all\", [\"==\", \"class\", \"trunk\"], [\"has\", \"congestion\"]]\r\n    ],\r\n    layout: {\r\n      visibility: \"visible\",\r\n      \"line-join\": \"round\",\r\n      \"line-cap\": \"round\"\r\n    },\r\n    paint: {\r\n      \"line-width\": {\r\n        base: 1.5,\r\n        stops: [\r\n          [8, 0.5],\r\n          [9, 2.25],\r\n          [18, 13],\r\n          [20, 17.5]\r\n        ]\r\n      },\r\n      \"line-color\": {\r\n        base: 1,\r\n        type: \"categorical\",\r\n        property: \"congestion\",\r\n        stops: [\r\n          [\"low\", \"hsl(145, 95%, 30%)\"],\r\n          [\"moderate\", \"hsl(30, 100%, 42%)\"],\r\n          [\"heavy\", \"hsl(355, 100%, 37%)\"],\r\n          [\"severe\", \"hsl(355, 70%, 22%)\"]\r\n        ]\r\n      },\r\n      \"line-offset\": {\r\n        base: 1.5,\r\n        stops: [\r\n          [7, 0],\r\n          [9, 1],\r\n          [18, 13],\r\n          [20, 18]\r\n        ]\r\n      },\r\n      \"line-opacity\": 1\r\n    }\r\n  },\r\n  {\r\n    id: \"traffic-motorway-bg\",\r\n    type: \"line\",\r\n    metadata: {\r\n      \"mapbox:group\": \"4053de47c16e55481b10fd748eaa994c\"\r\n    },\r\n    source: \"mapbox://mapbox.mapbox-traffic-v1\",\r\n    \"source-layer\": \"traffic\",\r\n    minzoom: 6,\r\n    filter: [\r\n      \"all\",\r\n      [\"==\", \"$type\", \"LineString\"],\r\n      [\"all\", [\"==\", \"class\", \"motorway\"], [\"has\", \"congestion\"]]\r\n    ],\r\n    layout: {\r\n      visibility: \"visible\",\r\n      \"line-join\": \"round\",\r\n      \"line-cap\": \"round\"\r\n    },\r\n    paint: {\r\n      \"line-width\": {\r\n        base: 1.5,\r\n        stops: [\r\n          [6, 0.5],\r\n          [9, 3],\r\n          [18, 16],\r\n          [20, 20]\r\n        ]\r\n      },\r\n      \"line-color\": {\r\n        base: 1,\r\n        type: \"categorical\",\r\n        property: \"congestion\",\r\n        stops: [\r\n          [\"low\", \"hsl(145, 95%, 30%)\"],\r\n          [\"moderate\", \"hsl(30, 100%, 42%)\"],\r\n          [\"heavy\", \"hsl(355, 100%, 37%)\"],\r\n          [\"severe\", \"hsl(355, 70%, 22%)\"]\r\n        ]\r\n      },\r\n      \"line-opacity\": 1,\r\n      \"line-offset\": {\r\n        base: 1.5,\r\n        stops: [\r\n          [7, 0],\r\n          [9, 1.2],\r\n          [11, 1.2],\r\n          [18, 10],\r\n          [20, 15.5]\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  {\r\n    id: \"traffic-primary\",\r\n    metadata: {\r\n      \"mapbox:group\": \"4053de47c16e55481b10fd748eaa994c\"\r\n    },\r\n    ref: \"traffic-primary-bg\",\r\n    paint: {\r\n      \"line-width\": {\r\n        base: 1.5,\r\n        stops: [\r\n          [10, 1],\r\n          [15, 4],\r\n          [20, 16]\r\n        ]\r\n      },\r\n      \"line-color\": {\r\n        base: 1,\r\n        type: \"categorical\",\r\n        property: \"congestion\",\r\n        stops: [\r\n          [\"low\", \"hsl(142, 55%, 50%)\"],\r\n          [\"moderate\", \"hsl(30, 100%, 55%)\"],\r\n          [\"heavy\", \"hsl(355, 100%, 50%)\"],\r\n          [\"severe\", \"hsl(355, 70%, 35%)\"]\r\n        ]\r\n      },\r\n      \"line-offset\": {\r\n        base: 1.2,\r\n        stops: [\r\n          [10, 0],\r\n          [12, 1.5],\r\n          [18, 13],\r\n          [20, 16]\r\n        ]\r\n      },\r\n      \"line-opacity\": 1\r\n    }\r\n  },\r\n  {\r\n    id: \"traffic-secondary-tertiary\",\r\n    metadata: {\r\n      \"mapbox:group\": \"4053de47c16e55481b10fd748eaa994c\"\r\n    },\r\n    ref: \"traffic-secondary-tertiary-bg\",\r\n    paint: {\r\n      \"line-width\": {\r\n        base: 1.5,\r\n        stops: [\r\n          [9, 0.5],\r\n          [18, 9],\r\n          [20, 14]\r\n        ]\r\n      },\r\n      \"line-color\": {\r\n        base: 1,\r\n        type: \"categorical\",\r\n        property: \"congestion\",\r\n        stops: [\r\n          [\"low\", \"hsl(142, 55%, 50%)\"],\r\n          [\"moderate\", \"hsl(30, 100%, 55%)\"],\r\n          [\"heavy\", \"hsl(355, 100%, 50%)\"],\r\n          [\"severe\", \"hsl(355, 70%, 35%)\"]\r\n        ]\r\n      },\r\n      \"line-offset\": {\r\n        base: 1.5,\r\n        stops: [\r\n          [10, 0.5],\r\n          [15, 5],\r\n          [18, 11],\r\n          [20, 14.5]\r\n        ]\r\n      },\r\n      \"line-opacity\": 1\r\n    }\r\n  },\r\n  {\r\n    id: \"traffic-street-link\",\r\n    metadata: {\r\n      \"mapbox:group\": \"4053de47c16e55481b10fd748eaa994c\"\r\n    },\r\n    ref: \"traffic-street-link-bg\",\r\n    paint: {\r\n      \"line-width\": {\r\n        base: 1.5,\r\n        stops: [\r\n          [14, 1.5],\r\n          [20, 13.5]\r\n        ]\r\n      },\r\n      \"line-color\": {\r\n        base: 1,\r\n        type: \"categorical\",\r\n        property: \"congestion\",\r\n        stops: [\r\n          [\"low\", \"hsl(142, 55%, 50%)\"],\r\n          [\"moderate\", \"hsl(30, 100%, 55%)\"],\r\n          [\"heavy\", \"hsl(355, 100%, 50%)\"],\r\n          [\"severe\", \"hsl(355, 70%, 35%)\"]\r\n        ]\r\n      },\r\n      \"line-offset\": {\r\n        base: 1.5,\r\n        stops: [\r\n          [14, 2],\r\n          [20, 18]\r\n        ]\r\n      },\r\n      \"line-opacity\": 1\r\n    }\r\n  },\r\n  {\r\n    id: \"traffic-trunk\",\r\n    metadata: {\r\n      \"mapbox:group\": \"4053de47c16e55481b10fd748eaa994c\"\r\n    },\r\n    ref: \"traffic-trunk-bg\",\r\n    paint: {\r\n      \"line-width\": {\r\n        base: 1.5,\r\n        stops: [\r\n          [8, 0.75],\r\n          [18, 11],\r\n          [20, 15]\r\n        ]\r\n      },\r\n      \"line-color\": {\r\n        base: 1,\r\n        type: \"categorical\",\r\n        property: \"congestion\",\r\n        stops: [\r\n          [\"low\", \"hsl(142, 55%, 50%)\"],\r\n          [\"moderate\", \"hsl(30, 100%, 55%)\"],\r\n          [\"heavy\", \"hsl(355, 100%, 50%)\"],\r\n          [\"severe\", \"hsl(355, 70%, 35%)\"]\r\n        ]\r\n      },\r\n      \"line-offset\": {\r\n        base: 1.5,\r\n        stops: [\r\n          [7, 0],\r\n          [9, 1],\r\n          [18, 13],\r\n          [20, 18]\r\n        ]\r\n      },\r\n      \"line-opacity\": 1\r\n    }\r\n  },\r\n  {\r\n    id: \"traffic-motorway\",\r\n    metadata: {\r\n      \"mapbox:group\": \"4053de47c16e55481b10fd748eaa994c\"\r\n    },\r\n    ref: \"traffic-motorway-bg\",\r\n    paint: {\r\n      \"line-width\": {\r\n        base: 1.5,\r\n        stops: [\r\n          [6, 0.5],\r\n          [9, 1.5],\r\n          [18, 14],\r\n          [20, 18]\r\n        ]\r\n      },\r\n      \"line-color\": {\r\n        base: 1,\r\n        type: \"categorical\",\r\n        property: \"congestion\",\r\n        stops: [\r\n          [\"low\", \"hsl(142, 55%, 50%)\"],\r\n          [\"moderate\", \"hsl(30, 100%, 55%)\"],\r\n          [\"heavy\", \"hsl(355, 100%, 50%)\"],\r\n          [\"severe\", \"hsl(355, 70%, 35%)\"]\r\n        ]\r\n      },\r\n      \"line-opacity\": 1,\r\n      \"line-offset\": {\r\n        base: 1.5,\r\n        stops: [\r\n          [7, 0],\r\n          [9, 1.2],\r\n          [11, 1.2],\r\n          [18, 10],\r\n          [20, 15.5]\r\n        ]\r\n      }\r\n    }\r\n  }\r\n];\r\n\r\nfunction addLayers(style, layers, before) {\r\n  for (var i = 0; i < style.layers.length; i++) {\r\n    var layer = style.layers[i];\r\n    if (before === layer.id) {\r\n      var newLayers = style.layers\r\n        .slice(0, i)\r\n        .concat(layers)\r\n        .concat(style.layers.slice(i));\r\n      return Object.assign({}, style, {\r\n        layers: newLayers\r\n      });\r\n    }\r\n  }\r\n  return style;\r\n}\r\n\r\n/**\r\n * Create a new [Mapbox GL JS plugin](https://www.mapbox.com/blog/build-mapbox-gl-js-plugins/) that allows you to hide and show\r\n * traffic layers in your map and an optional toggle button.\r\n * @constructor\r\n * @param {object} options - Options to configure the plugin.\r\n * @param {boolean} [options.showTraffic=false] - Show or hide traffic overlay by default.\r\n * @param {boolean} [options.showTrafficButton=true] - Show a toggle button to turn traffic on and off.\r\n * @param {RegExp} [options.trafficSource=/mapbox-traffic-v\\d/] - The traffic source regex used to determine whether a layer displays traffic or not.\r\n */\r\nfunction MapboxTraffic(options) {\r\n  if (!(this instanceof MapboxTraffic)) {\r\n    throw new Error(\"MapboxTraffic needs to be called with the new keyword\");\r\n  }\r\n\r\n  this.options = Object.assign(\r\n    {\r\n      showTraffic: false,\r\n      showTrafficButton: true,\r\n      trafficSource: /mapbox-traffic-v\\d/\r\n    },\r\n    options\r\n  );\r\n\r\n  this.render = this.render.bind(this);\r\n  this.toggleTraffic = this.toggleTraffic.bind(this);\r\n  this._hideTraffic = this._hideTraffic.bind(this);\r\n  this._showTraffic = this._showTraffic.bind(this);\r\n  this._hasTraffic = this._hasTraffic.bind(this);\r\n  this._toggle = new TrafficButton({\r\n    show: this.options.showTrafficButton,\r\n    onToggle: this.toggleTraffic.bind(this)\r\n  });\r\n}\r\n\r\nMapboxTraffic.prototype._hasTraffic = function () {\r\n  var style = this._map.getStyle();\r\n  var trafficSource = this.options.trafficSource;\r\n  return (\r\n    Object.keys(style.sources).filter(function (sourceName) {\r\n      return trafficSource.test(sourceName);\r\n    }).length > 0\r\n  );\r\n};\r\n\r\n/**\r\n * Toggle visibility of traffic layer.\r\n */\r\nMapboxTraffic.prototype.toggleTraffic = function () {\r\n  this.options.showTraffic = !this.options.showTraffic;\r\n  this.render();\r\n};\r\n\r\nMapboxTraffic.prototype.render = function () {\r\n  if (!this._hasTraffic()) {\r\n    this._map.addSource(\"mapbox://mapbox.mapbox-traffic-v1\", {\r\n      type: \"vector\",\r\n      url: \"mapbox://mapbox.mapbox-traffic-v1\"\r\n    });\r\n\r\n    var roadLayers = this._map.getStyle().layers.filter(function (layer) {\r\n      return layer[\"source-layer\"] === \"road\";\r\n    });\r\n    var topRoadLayer = roadLayers[roadLayers.length - 1].id;\r\n    var style = this._map.getStyle();\r\n    var trafficStyle = addLayers(style, trafficLayers, topRoadLayer);\r\n    this._map.setStyle(trafficStyle);\r\n  }\r\n\r\n  if (this.options.showTraffic) {\r\n    this._showTraffic();\r\n    this._toggle.setMapIcon();\r\n  } else {\r\n    this._hideTraffic();\r\n    this._toggle.setTrafficIcon();\r\n  }\r\n};\r\n\r\nMapboxTraffic.prototype._hideTraffic = function () {\r\n  var style = this._map.getStyle();\r\n  var source = this.options.trafficSource;\r\n  style.layers.forEach(function (layer) {\r\n    if (source.test(layer[\"source\"])) {\r\n      layer[\"layout\"] = layer[\"layout\"] || {};\r\n      layer[\"layout\"][\"visibility\"] = \"none\";\r\n    }\r\n  });\r\n  this._map.setStyle(style);\r\n};\r\n\r\nMapboxTraffic.prototype._showTraffic = function () {\r\n  var style = this._map.getStyle();\r\n  var source = this.options.trafficSource;\r\n  style.layers.forEach(function (layer) {\r\n    if (source.test(layer[\"source\"])) {\r\n      layer[\"layout\"] = layer[\"layout\"] || {};\r\n      layer[\"layout\"][\"visibility\"] = \"visible\";\r\n    }\r\n  });\r\n  this._map.setStyle(style);\r\n};\r\n\r\nMapboxTraffic.prototype.onAdd = function (map) {\r\n  this._map = map;\r\n  map.on(\"load\", this.render);\r\n  return this._toggle.elem;\r\n};\r\n\r\nMapboxTraffic.prototype.onRemove = function () {\r\n  this._map.off(\"load\", this.render);\r\n\r\n  var elem = this._toggle.elem;\r\n  elem.parentNode.removeChild(elem);\r\n  this._map = undefined;\r\n};\r\n\r\nfunction container(child, show) {\r\n  var container = document.createElement(\"div\");\r\n  container.className = \"mapboxgl-ctrl mapboxgl-ctrl-group\";\r\n  container.appendChild(child);\r\n  if (!show) {\r\n    container.style.display = \"none\";\r\n  }\r\n  return container;\r\n}\r\n\r\nfunction button() {\r\n  var btn = document.createElement(\"button\");\r\n  btn.className = \"mapboxgl-ctrl-icon mapboxgl-ctrl-traffic\";\r\n  btn.type = \"button\";\r\n  btn[\"aria-label\"] = \"Inspect\";\r\n  return btn;\r\n}\r\n\r\nfunction TrafficButton(options) {\r\n  options = Object.assign(\r\n    {\r\n      show: true,\r\n      onToggle: function () {}\r\n    },\r\n    options\r\n  );\r\n\r\n  this._btn = button();\r\n  this._btn.onclick = options.onToggle;\r\n  this.elem = container(this._btn, options.show);\r\n}\r\n\r\nTrafficButton.prototype.setTrafficIcon = function () {\r\n  this._btn.className = \"mapboxgl-ctrl-icon mapboxgl-ctrl-traffic\";\r\n};\r\n\r\nTrafficButton.prototype.setMapIcon = function () {\r\n  this._btn.className = \"mapboxgl-ctrl-icon mapboxgl-ctrl-map\";\r\n};\r\n\r\nif (typeof module !== \"undefined\" && typeof module.exports !== \"undefined\") {\r\n  module.exports = MapboxTraffic;\r\n} else {\r\n  window.MapboxTraffic = MapboxTraffic;\r\n}\r\n"]}