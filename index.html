<!DOCTYPE html><html><head><meta charset="utf-8"><title>Add a custom style layer</title><meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no"><link href="https://api.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.css" rel="stylesheet"><script src="https://api.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.js"></script><script src="/csb-ntitd/mapbox-gl-traffic.31b6a6ed.js"></script><link href="/csb-ntitd/mapbox-gl-traffic.d0b997a9.css" rel="stylesheet"><style>body{margin:0;padding:0}#map{position:absolute;top:0;bottom:0;width:100%}</style></head><body> <div id="map"></div> <script>longitude=-122.21241175768318,latitude=37.38372172238322,zoomLevel=12,mapStyle="mapbox://styles/david-j-cardinal/cknmb5pvd237s17s46pxdk2d9",trafficStyle="mapbox://styles/mapbox/traffic-day-v2",mapboxgl.accessToken="pk.eyJ1IjoiZGF2aWQtai1jYXJkaW5hbCIsImEiOiJja25tYjFzZTgwOHFnMnVxemM0bHU2Z2EwIn0.TZ4pnGLEEf12QhkQuhsMbA";var a=window.map=new mapboxgl.Map({container:"map",zoom:zoomLevel,center:[longitude,latitude],style:trafficStyle,antialias:!0});a.addControl(new mapboxgl.NavigationControl),trafficControl=new MapboxTraffic,MapboxTraffic.showTrafficButton=!0,a.addControl(trafficControl);var t={id:"highlight",type:"custom",onAdd:function(a,t){var r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,"uniform mat4 u_matrix;attribute vec2 a_pos;void main() {    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);}"),t.compileShader(r);var o=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(o,"void main() {    gl_FragColor = vec4(1.0, 0.0, 0.0, 0.5);}"),t.compileShader(o),this.program=t.createProgram(),t.attachShader(this.program,r),t.attachShader(this.program,o),t.linkProgram(this.program),this.aPos=t.getAttribLocation(this.program,"a_pos");var e=mapboxgl.MercatorCoordinate.fromLngLat({lng:longitude,lat:latitude}),i=mapboxgl.MercatorCoordinate.fromLngLat({lng:longitude-.1,lat:latitude}),n=mapboxgl.MercatorCoordinate.fromLngLat({lng:longitude,lat:latitude+.1});this.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([e.x,e.y,i.x,i.y,n.x,n.y]),t.STATIC_DRAW)},render:function(a,t){a.useProgram(this.program),a.uniformMatrix4fv(a.getUniformLocation(this.program,"u_matrix"),!1,t),a.bindBuffer(a.ARRAY_BUFFER,this.buffer),a.enableVertexAttribArray(this.aPos),a.vertexAttribPointer(this.aPos,2,a.FLOAT,!1,0,0),a.enable(a.BLEND),a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA),a.drawArrays(a.TRIANGLE_STRIP,0,3)}};a.on("load",function(){a.addLayer(t,"building")});</script> </body></html>